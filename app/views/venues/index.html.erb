<div class="venues-wrapper row">
  <h1>Venues</h1>
  <% if @venues.blank? %>
    <h4>There are no Venues called <%= params[:search] %>.</h4>
  <% end %>
  <% @venues.each do |venue| %>
    <div class="venue">
      <div class="venue-head">
        <div class="title">
          <%= venue.title %>
        </div>
      </div>
      <div class="image center-block">
        <%= link_to (image_tag venue.image.url(:medium), class:'img-responsive'), venue_path(venue) %>
      </div>
      <p class="title">
        <%= venue.location %>
        <br/>
        <%= venue.description %>
        <br/>
        <%= (venue.votes_for - venue.votes_against) %>
        <br/>
        <% if current_user.voted_for?(venue) %>
        <%= link_to('vote for this post!') %>
        <% else %>
        <%= link_to('vote for this post!', vote_up_venue_path(venue), :method => :post) %>
        <% end %>
        <br/>
        <% if current_user.voted_against?(venue) %>
        <%= link_to('vote against this post!') %>
        <% else %>
        <%= link_to('vote against this post!', vote_down_venue_path(venue), :method => :post) %>
        <% end %>
        <br/>
        <%= link_to('Reset!', vote_reset_venue_path(venue), :method => :post) %>
        <br/>
        <% if venue.user_id == current_user.id %>
          <%= link_to 'Edit', edit_venue_path(venue) %>
        <% else %>
        <% end %>
      </p>
      <div class="venue-bottom">
        <% if venue.comments %>
          <% venue.comments.each do |comment| %>
            <div class="comment">
              <div class="user-name">
                <%= comment.user.user_name %>
              </div>
              <br/>
                <%= (comment.votes_for - comment.votes_against) %>
                <br/>
                <% if current_user.voted_for?(comment) %>
                <%= link_to('vote for this comment!') %>
                <% else %>
                <%= link_to('vote for this comment!', vote_up_venue_comment_path(venue, comment), :method => :post) %>
                <% end %>
                <br/>
                <% if current_user.voted_against?(comment) %>
                <%= link_to('vote against this comment!') %>
                <% else %>
                <%= link_to('vote against this comment!', vote_down_venue_comment_path(venue, comment), :method => :post) %>
                <% end %>
                <br/>
                <%= link_to('Reset!', vote_reset_venue_comment_path(venue, comment), :method => :post) %>
              <br/>
              <div class="comment-content">
                <%= comment.content %>
                <% if comment.image_file_name != nil %>
                  <%= image_tag comment.image.url(:small), class:'img-responsive' %>
                <% else %>
                <% end %>
              </div>
              <% if comment.user == current_user %>
                <%= link_to venue_comment_path(venue, comment), method: :delete, data: { confirm: "Are you sure?" } do %>
                  <i class="fa fa-times-circle" aria-hidden="true"></i>
                <% end %>
              <% end %>
            </div>
          <% end %>
        <% end %>
      </div>
      <div class="comment-like-form row">
        <div class="like-button col-sm-1">
          <i class="fa fa-heartbeat" aria-hidden="true"></i>
        </div>
        <div class="comment-form col-sm-11">
          <%= simple_form_for [venue, venue.comments.new] do |f| %>
            <%= f.input :image %>
            <%= f.input :content %>
            <%= f.button :submit %>
          <% end %>
        </div>
      </div>
    </div>
  <% end %>
  <% if params[:search] %>
  <% else %>
  <%= will_paginate @venues %>
  <% end %>
  <% unless @user.is_manager == true %>
  <% else %>
    <%= link_to 'New Venue', new_venue_path %>
  <% end %>
</div>
